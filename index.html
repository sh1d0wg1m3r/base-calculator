<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base Arithmetic & Conversion Masterclass</title>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #2563eb;
            --secondary: #0f172a;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #334155;
            --accent: #d946ef;
        }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--bg);
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Typography */
        h1, h2, h3 { color: var(--secondary); margin-top: 0; }
        h1 { border-bottom: 3px solid var(--primary); padding-bottom: 10px; margin-bottom: 30px; }
        h2 { margin-top: 40px; border-left: 5px solid var(--primary); padding-left: 15px; }
        code {
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-weight: bold;
            color: var(--accent);
        }

        /* Layout Components */
        .card {
            background: var(--card);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
        }

        /* Calculator Styles */
        .calculator-panel {
            background: var(--secondary);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 40px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .calc-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .calc-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #94a3b8;
        }

        input, select {
            width: 100%;
            padding: 12px;
            background: #334155;
            border: 1px solid #475569;
            border-radius: 6px;
            color: white;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        input:focus, select:focus {
            outline: 2px solid var(--primary);
            border-color: var(--primary);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 20px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
            flex: 1;
        }

        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: #1d4ed8; }
        
        .btn-accent { background: var(--accent); color: white; }
        .btn-accent:hover { background: #c026d3; }

        .result-display {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: monospace;
            border-left: 4px solid var(--accent);
        }

        .steps-container {
            margin-top: 15px;
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 6px;
            font-size: 0.9em;
            white-space: pre-wrap; /* Keeps formatting */
            border: 1px dashed #64748b;
        }

        .hidden { display: none; }
        
        /* MathJax fix for dark background */
        mjx-container { color: white !important; }
        .card mjx-container { color: var(--text) !important; }

    </style>
</head>
<body>

    <h1>Base Masterclass</h1>

    <div class="calculator-panel" id="calculator">
        <div class="calc-header">
            <h3 style="color:white; margin:0;">Student Lab</h3>
            
            <div style="min-width: 200px;">
                <label for="modeSelect">Tool Mode</label>
                <select id="modeSelect" onchange="toggleMode()">
                    <option value="arithmetic">Arithmetic (+ - * /)</option>
                    <option value="conversion">Conversion Only</option>
                </select>
            </div>
        </div>

        <div style="margin-bottom: 15px; display: grid; grid-template-columns: 2fr 1fr; gap: 10px;">
            <div>
                <label>Working Base</label>
                <select id="baseSelect" onchange="toggleCustomBase()">
                    <option value="2">Binary (Base 2)</option>
                    <option value="8">Octal (Base 8)</option>
                    <option value="10" selected>Decimal (Base 10)</option>
                    <option value="16">Hexadecimal (Base 16)</option>
                    <option value="custom">Custom Base...</option>
                </select>
            </div>
            <div id="customBaseContainer" class="hidden">
                <label>Enter Base (2-36)</label>
                <input type="number" id="customBaseInput" value="5" min="2" max="36">
            </div>
        </div>

        <div class="calc-controls">
            <div>
                <label id="labelA">Number A</label>
                <input type="text" id="numA" placeholder="e.g. 1010">
            </div>

            <div id="inputBContainer">
                <label>Number B</label>
                <input type="text" id="numB" placeholder="e.g. 0101">
            </div>
        </div>

        <div id="arithmeticButtons" class="btn-group">
            <button class="btn-primary" onclick="calculate('+')">+</button>
            <button class="btn-primary" onclick="calculate('-')">-</button>
            <button class="btn-primary" onclick="calculate('*')">×</button>
            <button class="btn-primary" onclick="calculate('/')">÷</button>
        </div>

        <div id="conversionButtons" class="btn-group hidden">
            <button class="btn-accent" onclick="convert()">Convert & Explain</button>
        </div>

        <div id="resultOutput" class="result-display">
            Select a mode and enter numbers to begin...
        </div>
    </div>

    <div class="card">
        <h2>Quick Navigation</h2>
        <ul>
            <li><a href="#conversions">How to Convert (Step-by-Step)</a></li>
            <li><a href="#binary">Binary Operations</a></li>
            <li><a href="#octal">Octal Operations</a></li>
            <li><a href="#hex">Hexadecimal Operations</a></li>
        </ul>
    </div>

    <h2 id="conversions">1. The "Any-to-Any" Conversion Strategy</h2>
    
    

    <div class="step-box">
        <strong>The Golden Rule:</strong><br>
        $$ \text{Source Base} \rightarrow \text{Decimal (Base 10)} \rightarrow \text{Target Base} $$
    </div>

    <div class="card">
        <h3>Part A: Any Base to Base 10 (Multiplication)</h3>
        <p>Use <strong>Positional Notation</strong>. Multiply each digit ($d$) by the base ($b$) raised to the power of its position ($i$).</p>
        $$ \text{Value} = \sum (d \times b^i) $$
        <p><strong>Example: Hex <code>2C</code> to Decimal</strong></p>
        <ul>
            <li>Positions: $C$ is at 0, $2$ is at 1.</li>
            <li>Calculation: $(2 \times 16^1) + (12 \times 16^0)$</li>
            <li>$32 + 12 = 44$</li>
        </ul>
    </div>

    <div class="card">
        <h3>Part B: Base 10 to Any Base (Division)</h3>
        <p>Use the <strong>Repeated Division Method</strong>.</p>
        <ol>
            <li>Divide the number by the target base.</li>
            <li>Write down the remainder.</li>
            <li>Use the quotient for the next step.</li>
            <li>Stop when quotient is 0.</li>
            <li>Read remainders <strong>Bottom-to-Top</strong>.</li>
        </ol>
    </div>

    <h2 id="binary">2. Binary Arithmetic (Base 2)</h2>
    <div class="card">
        <p><strong>Addition:</strong> $1+1=10_2$ (which is 2). Write 0, carry 1.</p>
        <p><strong>Subtraction:</strong> $0-1$ requires a borrow. The 0 becomes $10_2$ (2), so $2-1=1$.</p>
    </div>

    <footer style="margin-top: 50px; text-align: center; color: #64748b; font-size: 0.9em;">
        <p>Generated for Student Learning • Runs locally & on GitHub Pages</p>
    </footer>

    <script>
        // --- UI UTILS ---
        function toggleMode() {
            const mode = document.getElementById('modeSelect').value;
            const inputB = document.getElementById('inputBContainer');
            const arithBtns = document.getElementById('arithmeticButtons');
            const convBtns = document.getElementById('conversionButtons');
            const output = document.getElementById('resultOutput');

            output.innerHTML = 'Ready...';
            if (mode === 'arithmetic') {
                inputB.classList.remove('hidden');
                arithBtns.classList.remove('hidden');
                convBtns.classList.add('hidden');
            } else {
                inputB.classList.add('hidden');
                arithBtns.classList.add('hidden');
                convBtns.classList.remove('hidden');
            }
        }

        function toggleCustomBase() {
            const select = document.getElementById('baseSelect');
            const customInput = document.getElementById('customBaseContainer');
            if(select.value === 'custom') {
                customInput.classList.remove('hidden');
            } else {
                customInput.classList.add('hidden');
            }
        }

        function getBase() {
            const select = document.getElementById('baseSelect');
            if(select.value === 'custom') {
                const val = parseInt(document.getElementById('customBaseInput').value);
                return (val >= 2 && val <= 36) ? val : 10;
            }
            return parseInt(select.value);
        }

        // --- STEP GENERATORS ---

        // Generates "Photomath" style text for arithmetic
        function getArithmeticSteps(a, b, op, base) {
            let steps = `<strong>Step-by-Step Logic (Base ${base}):</strong>\n`;
            
            // Convert to decimal for calculation logic
            const decA = parseInt(a, base);
            const decB = parseInt(b, base);
            
            if (op === '+') {
                steps += `We are adding ${a} + ${b} in Base ${base}.\n\n`;
                steps += `Method: Column Addition\n`;
                
                // Pad strings to same length
                let sA = a.toString().split('').reverse();
                let sB = b.toString().split('').reverse();
                const len = Math.max(sA.length, sB.length);
                let carry = 0;
                let resultDigits = [];

                for(let i=0; i<len; i++) {
                    const d1 = parseInt(sA[i] || '0', base);
                    const d2 = parseInt(sB[i] || '0', base);
                    
                    let sum = d1 + d2 + carry;
                    let newCarry = Math.floor(sum / base);
                    let digit = sum % base;
                    
                    steps += `Column ${i} (Right to Left):\n`;
                    steps += `  ${d1} + ${d2} + ${carry} (carry) = ${sum} (decimal)\n`;
                    if(sum >= base) {
                        steps += `  ${sum} is >= ${base}. So: ${sum} - ${base} = ${digit}. Carry ${newCarry}.\n`;
                    } else {
                        steps += `  ${sum} fits in Base ${base}. Write ${digit}. Carry 0.\n`;
                    }
                    steps += `  -> Write: ${digit.toString(base).toUpperCase()}\n\n`;
                    
                    resultDigits.push(digit.toString(base).toUpperCase());
                    carry = newCarry;
                }
                if(carry > 0) {
                    steps += `Final Carry: Write ${carry}\n`;
                    resultDigits.push(carry.toString(base).toUpperCase());
                }
                steps += `\nFinal Result (Read up): ${resultDigits.reverse().join('')}`;
            }
            else if (op === '-') {
                steps += `We are subtracting ${a} - ${b} in Base ${base}.\n\n`;
                steps += `(Note: Logic shown uses decimal values for simpler understanding)\n`;
                steps += `1. Convert ${a} (base ${base}) -> ${decA} (dec)\n`;
                steps += `2. Convert ${b} (base ${base}) -> ${decB} (dec)\n`;
                steps += `3. Subtract: ${decA} - ${decB} = ${decA - decB} (dec)\n`;
                steps += `4. Convert result back to Base ${base}.\n`;
            }
            else {
                steps += `Operation: ${op}\n`;
                steps += `1. Convert operands to Decimal: ${decA} and ${decB}\n`;
                let res;
                if(op === '*') res = decA * decB;
                if(op === '/') res = Math.floor(decA / decB);
                steps += `2. Perform Math in Decimal: ${res}\n`;
                steps += `3. Convert ${res} back to Base ${base} using repeated division.`;
            }
            return steps;
        }

        // Generates conversion steps
        function getConversionSteps(valStr, base) {
            let steps = `<strong>1. Convert to Decimal:</strong>\n`;
            const digits = valStr.split('').reverse();
            let decimalSum = 0;
            
            // Part A: To Decimal
            digits.forEach((digit, index) => {
                const val = parseInt(digit, base);
                const power = Math.pow(base, index);
                const stepVal = val * power;
                decimalSum += stepVal;
                steps += `  Pos ${index}: ${digit} × ${base}^${index} = ${val} × ${power} = ${stepVal}\n`;
            });
            steps += `  Sum: ${decimalSum} (Decimal)\n\n`;

            // Part B: Show breakdown for standard bases
            steps += `<strong>2. Conversions:</strong>\n`;
            const bin = decimalSum.toString(2);
            const oct = decimalSum.toString(8);
            const hex = decimalSum.toString(16).toUpperCase();

            steps += `  To Binary (÷2): ${bin}\n`;
            steps += `  To Octal (÷8): ${oct}\n`;
            steps += `  To Hex (÷16): ${hex}\n`;

            return { steps, dec: decimalSum, bin, oct, hex };
        }

        // --- MAIN FUNCTIONS ---

        function convert() {
            const valA = document.getElementById('numA').value.trim();
            const base = getBase();
            const output = document.getElementById('resultOutput');
            
            if(!valA) { output.innerHTML = "Please enter a number."; return; }

            try {
                // Check validity
                const test = parseInt(valA, base);
                if (isNaN(test)) throw new Error("Invalid number for Base " + base);

                const data = getConversionSteps(valA, base);

                output.innerHTML = `
                    <div style="font-size: 1.2em; margin-bottom: 10px;">
                        Input: <strong>${valA}</strong> (Base ${base})
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; margin-bottom: 20px;">
                        <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:4px;">Bin: ${data.bin}</div>
                        <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:4px;">Oct: ${data.oct}</div>
                        <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:4px;">Dec: ${data.dec}</div>
                        <div style="background:rgba(255,255,255,0.1); padding:10px; border-radius:4px;">Hex: ${data.hex}</div>
                    </div>
                    <div class="steps-container">${data.steps}</div>
                `;
            } catch (e) {
                output.innerText = "Error: " + e.message;
            }
        }

        function calculate(op) {
            const strA = document.getElementById('numA').value.trim();
            const strB = document.getElementById('numB').value.trim();
            const base = getBase();
            const output = document.getElementById('resultOutput');

            if(!strA || !strB) { output.innerHTML = "Please enter both numbers."; return; }

            try {
                const a = parseInt(strA, base);
                const b = parseInt(strB, base);

                if (isNaN(a) || isNaN(b)) throw new Error("Invalid digits for Base " + base);

                let resDec = 0;
                let symbol = '';

                switch(op) {
                    case '+': resDec = a + b; symbol = '+'; break;
                    case '-': resDec = a - b; symbol = '-'; break;
                    case '*': resDec = a * b; symbol = '*'; break;
                    case '/': 
                        if(b === 0) throw new Error("Division by Zero");
                        resDec = Math.floor(a / b); 
                        symbol = '/'; 
                        break;
                }

                const resBase = resDec.toString(base).toUpperCase();
                const steps = getArithmeticSteps(strA, strB, op, base);

                output.innerHTML = `
                    <div style="font-size: 1.5em; margin-bottom: 5px;">
                        Result: <strong style="color: #4ade80;">${resBase}</strong> <small>(Base ${base})</small>
                    </div>
                    <div class="steps-container">${steps}</div>
                `;
            } catch (e) {
                output.innerText = "Error: " + e.message;
            }
        }
    </script>
</body>
</html>
